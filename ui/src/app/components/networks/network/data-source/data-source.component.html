<section class="content-header">
  <h1><i class="fa fa-share-alt"></i> {{ network?.name }} <small>patient empowered research</small>
  </h1>
</section>
<section class="content">
  <div class="row">
      <div class="col-md-8">
        <div class="box box-primary">
          <div class="box-header with-border">Data Source ( {{datamodel?.name}} )</div>
          <div class="box-body">
            <div *ngIf="success" class="alert alert-success alert-dismissible">
              <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
              <h4><i class="icon fa fa-check"></i> Succeeded!</h4>
              Data Source is updated!
            </div>
            <form #f [formGroup]="datasourceForm" (ngSubmit)="onSubmit()" novalidate>
              <div class="form-group has-feedback" [ngClass]="{'has-error': driver.invalid && (submitted || driver.dirty || driver.touched), 'has-success': driver.valid && (submitted || driver.dirty || driver.touched) }">
                <label>Database Type</label>
                <select formControlName="driver" class="form-control" name="driver">
                    <option value="oracle.jdbc.driver.OracleDriver" data-urlexample="jdbc:oracle:thin:@server.url:1521:sid">Oracle</option>
                    <option value="com.microsoft.sqlserver.jdbc.SQLServerDriver" data-urlexample="jdbc:sqlserver://server.name:1433;databaseName=DB_NAME;integratedSecurity=true;">SQL Server</option>
                  </select>
                <div class="help-block" *ngIf="driver.invalid && (submitted || driver.dirty || driver.touched)">Please select a database type</div>
              </div>
              <div class="form-group has-feedback" [ngClass]="{'has-error': url.invalid && (submitted || url.dirty || url.touched), 'has-success': url.valid && (submitted || url.dirty || url.touched) }">
                <label>Data source URL</label>
                <input type="text" formControlName="url" class="form-control" name="url" placeholder="Data source URL">
                <div class="help-block" *ngIf="url.invalid && (submitted || url.dirty || url.touched)">Please enter the data source url</div>
              </div>
              <div class="form-group has-feedback" [ngClass]="{'has-error': username.invalid && (submitted || username.dirty || username.touched), 'has-success': username.valid && (submitted || username.dirty || username.touched) }">
                <label>Data source Username</label>
                <input type="text" formControlName="username" class="form-control" name="username" placeholder="Data source Username">
                <div class="help-block" *ngIf="username.invalid && (submitted || username.dirty || username.touched)">Please enter the data source username</div>
              </div>
              <div class="form-group has-feedback" [ngClass]="{'has-error': password.invalid && (submitted || password.dirty || password.touched), 'has-success': password.valid && (submitted || password.dirty || password.touched) }">
                <label>Data source Password</label>
                <input type="password" formControlName="password" class="form-control" name="password" placeholder="Data source Password">
                <div class="help-block" *ngIf="password.invalid && (submitted || password.dirty || password.touched)">Please enter the data source password</div>
              </div>
              <div *ngIf="testResult" [ngClass]="{'text-green': testResult.result, 'text-red': !testResult.result}">{{ testResult.errorMsg }}. {{ testResult.detailErrorMsg }}</div>
              <button class="btn btn-danger">Change</button>
              <button class="btn btn-info" (click)="testDataSource($event)">Test</button>
              <a class="btn btn-link" [routerLink]="['../']">Cancel</a>
            </form>
            <div *ngIf="error" class="alert alert-danger">{{error}}</div>
          </div>
        </div>
      </div>
    </div>
</section>